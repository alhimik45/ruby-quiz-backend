questions = {"info":{"name":"Test Your Knowledge of Ruby and Rails!","main":"STUB<p>Think you're smart enough to be on Jeopardy? Find out with this super crazy knowledge quiz!</p>","results":"STUB<h5>Learn More</h5><p>Etiam scelerisque, nunc ac egestas consequat, odio nibh euismod nulla, eget auctor orci nibh vel nisi. Aliquam erat volutpat. Mauris vel neque sit amet nunc gravida congue sed sit amet purus.</p>","level1":"Great!","level2":"Nice!","level3":"Not bad!","level4":"You must learn to distinguish between the ruby and rails!","level5":"You need to learn basics!"},"questions":[{"q":"with_options","id":1,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p><p><span>with_options</span>(options, &block)</p>\n<p>An elegant way to factor duplication out of options passed to a series of method calls.\nEach method called in the block, with the block variable as the receiver, \nwill have its options merged with the default options hash provided.\nEach method called on the block variable must take an options hash as its final argumen</p>\n<p><a href='http://api.rubyonrails.org/?q=with_options'>api.rubyonrails.org</a></p>\n","incorrect":"<p><span>Uhh no.</span></p><p><p><span>with_options</span>(options, &block)</p>\n<p>An elegant way to factor duplication out of options passed to a series of method calls.\nEach method called in the block, with the block variable as the receiver, \nwill have its options merged with the default options hash provided.\nEach method called on the block variable must take an options hash as its final argumen</p>\n<p><a href='http://api.rubyonrails.org/?q=with_options'>api.rubyonrails.org</a></p>\n"},{"q":"reverse_merge","id":2,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"DateTime.current","id":3,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"Array(foo: :bar)      # => [[:foo, :bar]]","id":4,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":".to_json","id":5,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"Date.today","id":6,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"a.cycle { |x| puts x }     # print, a, b, c, a, b, c,.. forever..","id":7,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"Time.now","id":8,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":".downcase!","id":9,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"class_attribute","id":10,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"alias_attribute","id":11,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":".duplicable?","id":12,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"Array.wrap(nil)     # => [] </br> Array.wrap([1, 2, 3]) # => [1, 2, 3]</br> Array.wrap(0)    # => [0]","id":13,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"'hello'.at(4)  # => 'o'","id":14,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"aaa.instance_values","id":15,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"1.in?([1,2])","id":16,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"M.reachable?","id":17,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"delegate","id":18,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"descendants","id":19,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":".to_xml","id":20,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"(1..10).include?(3..7)  # => true </br> (1..10).include?(0..7)  # => false","id":21,"a":[{"option":"Rails","correct":true},{"option":"Ruby","correct":false}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"Hash[]","id":22,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":".superclass","id":23,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"420.modulo(4)","id":24,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"[1,2,3,4,5].sample","id":25,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"[%s] % \"same old drag\"             # => \"[same old drag]”","id":26,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"},{"q":"FileUtils.rm_r ‘somedir'","id":27,"a":[{"option":"Rails","correct":false},{"option":"Ruby","correct":true}],"correct":"<p><span>That's right!</span></p>","incorrect":"<p><span>Uhh no.</span></p><p>"}]}

$ ->
  $.get 'ask_statistic/stats', (stats) ->
    if stats.length != 0
      Morris.Bar
        element: 'chartdiv'
        data: stats
        xkey: 'id'
        hideHover: 'auto'
        hoverCallback: (index, opt, content)->
          text = ""
          if questions.questions[index]
            rightAnswer = questions.questions[index].a.filter((a) -> a.correct)[0].option
            text = "<b>#{rightAnswer}:</b><br/>#{questions.questions[index].q}"
          $('#ask-info').html(text)
          content
        ykeys: ['right', 'wrong']
        labels: ['Правильных ответов', 'Неправильных ответов']
    else
      $('#chartdiv').text 'Статистики нет'

